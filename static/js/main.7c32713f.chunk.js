(this.webpackJsonpwarehouse=this.webpackJsonpwarehouse||[]).push([[0],{19:function(e,t,n){},20:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(1),a=n.n(r),i=n(8),s=n.n(i),o=(n(19),n(12)),u=n(2),l=(n(20),n(3)),j=n.n(l),f=n(6),b="https://bad-api-assignment.reaktor.com/",h={method:"GET",headers:{"Content-Type":"application/json","Cache-Control":"max-age=300, must-revalidate"}},O="app-cache";function d(){return(d=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:caches.delete(O);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return v.apply(this,arguments)}function v(){return(v=Object(f.a)(j.a.mark((function e(t){var n,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,caches.open(O);case 2:return n=e.sent,e.next=5,n.match("".concat(b).concat(t));case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return m.apply(this,arguments)}function m(){return(m=Object(f.a)(j.a.mark((function e(t){var n,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,caches.open(O);case 2:return n=e.sent,e.next=5,p(t);case 5:if(void 0===(c=e.sent)){e.next=10;break}return e.abrupt("return",c.json());case 10:return e.abrupt("return",fetch("".concat(b).concat(t),h).then((function(e){if(e.ok)return n.add("".concat(b).concat(t)),setTimeout((function(){return n.delete("".concat(b).concat(t))}),3e5),e.json();throw new Error("request failed")})).catch(console.log));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var g=n.p+"static/media/loading.b33cf617.png";var S=function(){return Object(c.jsx)("div",{className:"flex-center",children:Object(c.jsx)("img",{src:g,alt:"loading",className:"rotation"})})};var w=function(e){var t=Object(r.useRef)(null),n=e.children.props.list,a=Object(r.useState)(1),i=Object(u.a)(a,2),s=i[0],o=i[1],l=Object(r.useState)(n.slice(0,20)),j=Object(u.a)(l,2),f=j[0],b=j[1],h=Object(r.useState)(!0),O=Object(u.a)(h,2),d=O[0],p=O[1];Object(r.useEffect)((function(){return v(),function(){o(1),b(n.slice(0,20))}}),[]),Object(r.useEffect)((function(){var e=Math.min(n.length,20*(s+1));e!==n.length&&p(!0),o(s+1),b(n.slice(0,e))}),[d]);var v=function(){new IntersectionObserver((function(){p(!1)}),{rootMargin:"0px",threshold:1}).observe(t.current)};return Object(c.jsxs)("div",{className:"scroll",children:[Object(c.jsx)(e.children.type,{list:f}),Object(c.jsx)("div",{ref:t,children:d&&Object(c.jsx)(S,{})})]})};var y=function(e){var t=e.info;return Object(c.jsxs)("div",{className:"card",children:[Object(c.jsxs)("div",{className:"fixed-height",children:[Object(c.jsx)("p",{className:"name",children:t.name}),Object(c.jsxs)("p",{children:["Price: ",t.price]}),Object(c.jsxs)("p",{children:["Colors: ",t.color.join("-")]}),Object(c.jsxs)("p",{children:["Mfr.: ",t.manufacturer]})]}),t.availability?Object(c.jsx)("p",{className:"OUT OF STOCK"===t.availability?"out":"LESS THAN 10"===t.availability?"less-than-10":"",children:t.availability}):Object(c.jsx)(S,{})]})};var T=function(e){var t=e.list;return Object(c.jsx)("div",{className:"grid",children:t.map((function(e,t){return Object(c.jsx)(y,{info:e},t)}))})};var C=function(e){var t=e.categories,n=e.categoryOnDisplay,r=e.switchCategory;return Object(c.jsx)("div",{className:"switcher flex-row",children:t.map((function(e,t){return Object(c.jsx)("button",{style:n===e?{border:"2px solid black"}:{},onClick:function(){return r(e)},children:e},t)}))})};var I=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)("shirts"),s=Object(u.a)(i,2),l=s[0],j=s[1],f=Object(r.useState)([]),b=Object(u.a)(f,2),h=b[0],O=b[1],d=Object(r.useState)(!0),p=Object(u.a)(d,2),v=p[0],m=p[1],g=Object(r.useState)(""),y=Object(u.a)(g,2),I=y[0],N=y[1],k=Object(r.useState)(-1),A=Object(u.a)(k,2),E=A[0],L=A[1];Object(r.useEffect)((function(){F()}),[l]),Object(r.useEffect)((function(){v||K()}),[E]),Object(r.useEffect)((function(){if(I)throw new Error(I)}),[I]);var F=function(){var e=new Set;x("products/".concat(l)).then((function(t){t.forEach((function(t){return e.add(t.manufacturer)})),a(t),m(!1),O(Object(o.a)(e)),L(0)})).catch((function(e){N(e)}))},K=function(){if(E!==h.length){var e=h[E];x("availability/".concat(e)).then((function(t){for(var c=t.response,r=function(t){if(n[t].manufacturer!==e)return"continue";var r=c.find((function(e){return n[t].id===e.id.toLowerCase()}));if(void 0!==r){var a=function(e){var t=e.replace("<AVAILABILITY>\n  <INSTOCKVALUE>","");switch(t=t.replace("</INSTOCKVALUE>\n</AVAILABILITY>","")){case"OUTOFSTOCK":t="OUT OF STOCK";break;case"LESSTHAN10":t="LESS THAN 10";break;case"INSTOCK":t="IN STOCK"}return t}(r.DATAPAYLOAD);n[t].availability=a}},i=0;i<n.length;i++)r(i);a(n),L(E+1)})).catch((function(e){N(e)}))}};return Object(c.jsxs)("div",{children:[Object(c.jsx)(C,{categoryOnDisplay:l,categories:["jackets","shirts","accessories"],switchCategory:function(e){j(e),m(!0)}}),v?Object(c.jsx)(S,{}):Object(c.jsx)(w,{children:Object(c.jsx)(T,{list:n})})]})},N=n(9),k=n(10),A=n(13),E=n(11),L=function(e){Object(A.a)(n,e);var t=Object(E.a)(n);function n(e){var c;return Object(N.a)(this,n),(c=t.call(this)).state={error:null,errorInfo:null},c}return Object(k.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t}),function(){d.apply(this,arguments)}(),setTimeout((function(){return window.location.reload()}),5e3)}},{key:"render",value:function(){return this.state.errorInfo?Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Small error occured"}),Object(c.jsx)("p",{children:"The page will reload in 5s."}),Object(c.jsx)("h1",{children:"We are sorry!"})]}):this.props.children}}]),n}(a.a.Component);var F=function(){return Object(c.jsx)("div",{children:Object(c.jsx)(L,{children:Object(c.jsx)(I,{})})})},K=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};s.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(F,{})}),document.getElementById("root")),K()}},[[22,1,2]]]);
//# sourceMappingURL=main.7c32713f.chunk.js.map